{"version":3,"sources":["../../../../assets/scripts/assets/scripts/Star.js"],"names":["cc","Class","extends","Component","properties","pickRadius","onLoad","getPlayDist","playerPos","game","player","getPosition","dist","node","position","sub","mag","onPicked","spawnNewStar","destroy","pos","gainScore","update","dt","opacityRatio","timer","starDuration","minOpacity","opacity","Math","floor"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAY;AADJ,KAHP;;AAOL;;AAEAC,UATK,oBASK,CACT,CAVI;;;AAYLC,iBAAa,uBAAU;AACnB,YAAIC,YAAY,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,WAAjB,EAAhB;AACA,YAAIC,OAAQ,KAAKC,IAAL,CAAUC,QAAV,CAAmBC,GAAnB,CAAuBP,SAAvB,EAAkCQ,GAAlC,EAAZ;AACA,eAAOJ,IAAP;AACH,KAhBI;;AAkBLK,cAAU,oBAAU;AAChB,aAAKR,IAAL,CAAUS,YAAV;AACA,aAAKL,IAAL,CAAUM,OAAV;AACA;AACA,YAAIC,MAAM,KAAKP,IAAL,CAAUF,WAAV,EAAV;AACA,aAAKF,IAAL,CAAUY,SAAV,CAAoBD,GAApB;AACH,KAxBI;;AA2BJE,UA3BI,kBA2BIC,EA3BJ,EA2BQ;AACR;AACA,YAAIC,eAAe,IAAI,KAAKf,IAAL,CAAUgB,KAAV,GAAgB,KAAKhB,IAAL,CAAUiB,YAAjD;AACA,YAAIC,aAAa,EAAjB;AACA;AACA,aAAKd,IAAL,CAAUe,OAAV,GAAoBD,aAAaE,KAAKC,KAAL,CAAWN,gBAAgB,MAAMG,UAAtB,CAAX,CAAjC;AACA,YAAI,KAAKpB,WAAL,KAAqB,KAAKF,UAA9B,EAAyC;AACtC,iBAAKY,QAAL;AACA;AACF;AACJ;AArCG,CAAT","file":"Star.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        pickRadius: 0\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n    },\n\n    getPlayDist: function(){\n        let playerPos = this.game.player.getPosition();\n        let dist  = this.node.position.sub(playerPos).mag();\n        return dist;\n    },\n\n    onPicked: function(){\n        this.game.spawnNewStar();\n        this.node.destroy();\n        // 得分\n        let pos = this.node.getPosition();\n        this.game.gainScore(pos);\n    },\n\n\n     update (dt) {\n         // 根据 Game 脚本中的计时器更新星星的透明度\n         let opacityRatio = 1 - this.game.timer/this.game.starDuration;\n         let minOpacity = 50;\n         // 节点透明度，默认值为 255。\n         this.node.opacity = minOpacity + Math.floor(opacityRatio * (255 - minOpacity));\n         if (this.getPlayDist() < this.pickRadius){\n            this.onPicked()\n            return\n         }\n     },\n});\n"]}